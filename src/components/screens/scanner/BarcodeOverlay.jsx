/* eslint-disable max-len */
import { useState } from 'react';
import { View } from 'react-native';

import Svg, { Path } from 'react-native-svg';
import styled from 'styled-components/native';

export default function BarcodeOverlay () {
	const [scale, setScale] = useState(0),
		onLayout = (event) => {
			let { width, height } = event.nativeEvent.layout,
				ratio = width / height,
				size = Math.min(Math.min(width, height) - 50, 400),
				newScale = Math.round(size / WINDOW_SIZE * 100) / 100;

			if (ratio < 0.23492 || Math.max(width, height) >= OVERLAY_SIZE * newScale) return setScale(0);
			setScale(newScale);
		};

	return (
		<BarcodeOverlayLayout onLayout={onLayout}>
			<Window scale={scale}>
				<OverlaySvg viewBox='0 0 4000 4000'>
					<Path fillOpacity='0.65' fill='#000000' fillRule='evenodd' stroke='none' d={OVERLAY_PATH} />
				</OverlaySvg>
			</Window>
		</BarcodeOverlayLayout>
	);
}

const OVERLAY_SIZE = 4000,
	WINDOW_SIZE = 700,

	BarcodeOverlayLayout = styled(View)`
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		justify-content: center;
		align-items: center;
	`,
	Window = styled(View)`
		position: absolute;
		width: ${() => WINDOW_SIZE}px;
		height: ${() => WINDOW_SIZE}px;
		justify-content: center;
		align-items: center;
		transform: scale(${({ scale }) => scale});
	`,
	OverlaySvg = styled(Svg)`
		min-width: ${() => OVERLAY_SIZE}px;
		min-height: ${() => OVERLAY_SIZE}px;
	`,

	OVERLAY_PATH = 'M4000 0L0 0L0 4000L4000 4000L4000 0ZM2300 1650L1700 1650Q1698.77 1650 1697.55 1650.06Q1696.32 1650.12 1695.1 1650.24Q1693.88 1650.36 1692.66 1650.54Q1691.45 1650.72 1690.24 1650.96Q1689.04 1651.2 1687.85 1651.5Q1686.66 1651.8 1685.49 1652.15Q1684.31 1652.51 1683.15 1652.92Q1682 1653.34 1680.87 1653.81Q1679.73 1654.28 1678.62 1654.8Q1677.51 1655.33 1676.43 1655.9Q1675.35 1656.48 1674.29 1657.11Q1673.24 1657.74 1672.22 1658.43Q1671.2 1659.11 1670.21 1659.84Q1669.23 1660.57 1668.28 1661.35Q1667.33 1662.13 1666.42 1662.95Q1665.51 1663.78 1664.64 1664.64Q1663.78 1665.51 1662.95 1666.42Q1662.13 1667.33 1661.35 1668.28Q1660.57 1669.23 1659.84 1670.21Q1659.11 1671.2 1658.43 1672.22Q1657.74 1673.24 1657.11 1674.29Q1656.48 1675.35 1655.9 1676.43Q1655.33 1677.51 1654.8 1678.62Q1654.28 1679.73 1653.81 1680.86Q1653.34 1682 1652.92 1683.15Q1652.51 1684.31 1652.15 1685.48Q1651.8 1686.66 1651.5 1687.85Q1651.2 1689.04 1650.96 1690.24Q1650.72 1691.45 1650.54 1692.66Q1650.36 1693.88 1650.24 1695.1Q1650.12 1696.32 1650.06 1697.55Q1650 1698.77 1650 1700L1650 2300Q1650 2301.23 1650.06 2302.45Q1650.12 2303.68 1650.24 2304.9Q1650.36 2306.12 1650.54 2307.34Q1650.72 2308.55 1650.96 2309.76Q1651.2 2310.96 1651.5 2312.15Q1651.8 2313.34 1652.15 2314.52Q1652.51 2315.69 1652.92 2316.84Q1653.34 2318 1653.81 2319.13Q1654.28 2320.27 1654.8 2321.38Q1655.33 2322.49 1655.9 2323.57Q1656.48 2324.65 1657.11 2325.71Q1657.74 2326.76 1658.43 2327.78Q1659.11 2328.8 1659.84 2329.79Q1660.57 2330.77 1661.35 2331.72Q1662.13 2332.67 1662.95 2333.58Q1663.78 2334.49 1664.64 2335.36Q1665.51 2336.22 1666.42 2337.05Q1667.33 2337.87 1668.28 2338.65Q1669.23 2339.43 1670.21 2340.16Q1671.2 2340.89 1672.22 2341.57Q1673.24 2342.26 1674.29 2342.89Q1675.35 2343.52 1676.43 2344.1Q1677.51 2344.67 1678.62 2345.2Q1679.73 2345.72 1680.87 2346.19Q1682 2346.66 1683.15 2347.08Q1684.31 2347.49 1685.49 2347.85Q1686.66 2348.2 1687.85 2348.5Q1689.04 2348.8 1690.24 2349.04Q1691.45 2349.28 1692.66 2349.46Q1693.88 2349.64 1695.1 2349.76Q1696.32 2349.88 1697.55 2349.94Q1698.77 2350 1700 2350L2300 2350Q2301.23 2350 2302.45 2349.94Q2303.68 2349.88 2304.9 2349.76Q2306.12 2349.64 2307.34 2349.46Q2308.55 2349.28 2309.76 2349.04Q2310.96 2348.8 2312.15 2348.5Q2313.34 2348.2 2314.52 2347.85Q2315.69 2347.49 2316.84 2347.08Q2318 2346.66 2319.13 2346.19Q2320.27 2345.72 2321.38 2345.2Q2322.49 2344.67 2323.57 2344.1Q2324.65 2343.52 2325.71 2342.89Q2326.76 2342.26 2327.78 2341.57Q2328.8 2340.89 2329.79 2340.16Q2330.77 2339.43 2331.72 2338.65Q2332.67 2337.87 2333.58 2337.05Q2334.49 2336.22 2335.36 2335.36Q2336.22 2334.49 2337.05 2333.58Q2337.87 2332.67 2338.65 2331.72Q2339.43 2330.77 2340.16 2329.79Q2340.89 2328.8 2341.57 2327.78Q2342.26 2326.76 2342.89 2325.71Q2343.52 2324.65 2344.1 2323.57Q2344.67 2322.49 2345.2 2321.38Q2345.72 2320.27 2346.19 2319.13Q2346.66 2318 2347.08 2316.84Q2347.49 2315.69 2347.85 2314.51Q2348.2 2313.34 2348.5 2312.15Q2348.8 2310.96 2349.04 2309.76Q2349.28 2308.55 2349.46 2307.34Q2349.64 2306.12 2349.76 2304.9Q2349.88 2303.68 2349.94 2302.45Q2350 2301.23 2350 2300L2350 1700Q2350 1698.77 2349.94 1697.55Q2349.88 1696.32 2349.76 1695.1Q2349.64 1693.88 2349.46 1692.66Q2349.28 1691.45 2349.04 1690.24Q2348.8 1689.04 2348.5 1687.85Q2348.2 1686.66 2347.85 1685.49Q2347.49 1684.31 2347.08 1683.15Q2346.66 1682 2346.19 1680.86Q2345.72 1679.73 2345.2 1678.62Q2344.67 1677.51 2344.1 1676.43Q2343.52 1675.35 2342.89 1674.29Q2342.26 1673.24 2341.57 1672.22Q2340.89 1671.2 2340.16 1670.21Q2339.43 1669.23 2338.65 1668.28Q2337.87 1667.33 2337.05 1666.42Q2336.22 1665.51 2335.36 1664.64Q2334.49 1663.78 2333.58 1662.95Q2332.67 1662.13 2331.72 1661.35Q2330.77 1660.57 2329.79 1659.84Q2328.8 1659.11 2327.78 1658.43Q2326.76 1657.74 2325.71 1657.11Q2324.65 1656.48 2323.57 1655.9Q2322.49 1655.33 2321.38 1654.8Q2320.27 1654.28 2319.13 1653.81Q2318 1653.34 2316.84 1652.92Q2315.69 1652.51 2314.51 1652.15Q2313.34 1651.8 2312.15 1651.5Q2310.96 1651.2 2309.76 1650.96Q2308.55 1650.72 2307.34 1650.54Q2306.12 1650.36 2304.9 1650.24Q2303.68 1650.12 2302.45 1650.06Q2301.23 1650 2300 1650Z';
